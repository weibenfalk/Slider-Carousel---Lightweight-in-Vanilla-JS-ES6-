<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Hero Slider</title>
  <link rel="stylesheet" href="style/style.css">
</head>
<body>
  <div id="wbn-slider">
    <div class="wbn-images-wrapper">
      <div class="wbn-slide"><img src="img/slide1.png" /></div>
      <div class="wbn-slide"><img src="img/slide2.png" /></div>
      <div class="wbn-slide"><img src="img/slide3.png" /></div>
      <div class="wbn-slide active"><img src="img/slide4.png" /></div>
      <div class="wbn-slide"><img src="img/slide5.png" /></div>
      <div class="wbn-slide"><img src="img/slide6.png" /></div>
      <div class="wbn-slide"><img src="img/slide7.png" /></div>
      <div class="wbn-slide"><img src="img/slide8.png" /></div>
    </div>

    <div class="wbn-slider-btn-wrapper left">
        <div class="wbn-slider-back-btn">
            <span>◀</span>
          </div>
    </div>

    <div class="wbn-slider-btn-wrapper right">
        <div class="wbn-slider-next-btn">
            <span>▶</span>
          </div>
    </div>
  </div>

  <script>
    const backButton = document.querySelector('.wbn-slider-back-btn');
    const forwardButton = document.querySelector('.wbn-slider-next-btn');

    // Convert to array for easy handling
    const allSlides = Array.from(document.querySelectorAll('.wbn-slide'));

    const active = document.querySelector('.active');
    const activeIndex = allSlides.indexOf(active);

    // TODO: Fix this to work with any start img
    allSlides[activeIndex + 1].classList.add('slideRight');
    allSlides[activeIndex - 1].classList.add('slideLeft');

    function changeSlide(direction) {
      const dir = direction;
      const active = document.querySelector('.active');
      const activeIndex = allSlides.indexOf(active);

      // The two first can be used for both back and forward
      const slide1Index = (activeIndex + 1) % allSlides.length;
      const slide2Index = (activeIndex - 1 + allSlides.length) % allSlides.length;
      // This one is different depending on back or forward
      // We also send different slides to different parameters depending on back of forward
      if (dir === "back") {
        const slide3Index = (activeIndex - 2 + allSlides.length) % allSlides.length;
        updateUI(active, dir, slide2Index, slide1Index, slide3Index);
      } else {
        const slide3Index = (activeIndex + 2) % allSlides.length;
        updateUI(active, dir, slide1Index, slide2Index, slide3Index);
      }
    }

    function updateUI(active, dir, slide1Index, slide2Index, slide3Index) {
      let class1, class2;

      if (dir === "back") {
        class1 = 'slideLeft';
        class2 = 'slideRight';
      } else {
        class1 = 'slideRight';
        class2 = 'slideLeft';
      }

      // Hide all slides first
      for(let element of allSlides) {
          element.classList.add('hide');
      }

      active.classList.remove('hide', 'active');
      active.classList.add(class2);
      active.addEventListener('transitionend', hideElement);

      allSlides[slide1Index].classList.remove('hide', class1);
      allSlides[slide1Index].classList.add('active');

      allSlides[slide2Index].classList.remove(class2);
      allSlides[slide3Index].classList.add(class1);

      function hideElement(e) {
        e.target.classList.add('hide');
        active.removeEventListener('transitionend', hideElement);
      }
    }

    //Event listeners
    forwardButton.addEventListener('click', () => { changeSlide('forward') });
    backButton.addEventListener('click', () => { changeSlide('back') });

   </script>

</body>
</html>